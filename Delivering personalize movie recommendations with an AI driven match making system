# Step 1: Upload IMDb TSV file
from google.colab import files
uploaded = files.upload()

# Step 2: Load the .tsv.gz file using pandas
import pandas as pd

# Load the IMDb dataset
df = pd.read_csv('title.basics.tsv.gz', sep='\t', compression='gzip', low_memory=False)

# Step 3: Filter only movies with valid titles and years
movies_df = df[
    (df['titleType'] == 'movie') &
    (df['isAdult'] == 0) &
    (df['startYear'].notna()) &
    (df['primaryTitle'].notna())
]

# Optional: Reset index and keep only necessary columns
movies_df = movies_df[['tconst', 'primaryTitle', 'startYear', 'genres']]
movies_df = movies_df.rename(columns={
    'tconst': 'movieId',
    'primaryTitle': 'title',
    'startYear': 'year'
})
movies_df.reset_index(drop=True, inplace=True)

# Step 4: Display top 5 movies
print("Total Movies Found:", len(movies_df))
movies_df.head()

# Step 5: Save filtered movie list as CSV
movies_df.to_csv("imdb_movies_filtered.csv", index=False)

# Download the file to your device
files.download("imdb_movies_filtered.csv")
